<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!--
  ROS2 Control tanımı
  NOT: Hardware interface kullanmıyoruz, serial bridge /joint_states yayınlıyor.
  Controller'ın çalışması için minimal ros2_control tanımı gerekli.
  -->

  <xacro:macro name="my_robot_ros2_control" params="name prefix">
    <ros2_control name="${name}" type="system">
      <hardware>
        <!-- 
        Hardware interface yok, serial bridge kullanıyoruz.
        Controller /joint_states topic'ini kullanacak.
        Bu sadece controller'ın başlaması için gerekli.
        fake_components/GenericSystem kullanıyoruz (ros2_control paketinde var).
        -->
        <plugin>fake_components/GenericSystem</plugin>
        <param name="state_following_offset">0.0</param>
        <param name="fake_sensor_commands">false</param>
      </hardware>
      <joint name="${prefix}left_wheel_joint">
        <command_interface name="velocity"/>
        <state_interface name="position"/>
        <state_interface name="velocity"/>
      </joint>
      <joint name="${prefix}right_wheel_joint">
        <command_interface name="velocity"/>
        <state_interface name="position"/>
        <state_interface name="velocity"/>
      </joint>
    </ros2_control>
  </xacro:macro>

</robot>
